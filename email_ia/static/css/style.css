:root{
    --bg:#f6f7fb;
    --bg2:#eef2fb;
    --card:#ffffff;
    --surface:#fbfbff;
    --surface-2:#eef2ff;
    --panel:rgba(255,255,255,0.65);
    --border:#e6e9f2;
    --border-2:#eef2ff;
    --text:#111827;
    --primary:#5b46ff;
    --primary-dark:#4536d6;
    --muted:#6b7280;
    --success:#16a34a;
    --accent:#7c3aed;
    --danger:#dc2626;
}

body[data-theme="dark"]{
    --bg:#0b1020;
    --bg2:#060814;
    --card:#0f172a;
    --surface:#111c33;
    --surface-2:#162042;
    --panel:rgba(15,23,42,0.70);
    --border:rgba(255,255,255,0.10);
    --border-2:rgba(255,255,255,0.12);
    --text:#e5e7eb;
    --muted:#a6adbb;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
    font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    background: linear-gradient(180deg, var(--bg), var(--bg2) 70%);
    display:flex;
    align-items:center;
    justify-content:center;
    padding:40px;
    color:var(--text);
}

/* Splash screen */
.splash{
    position:fixed;
    inset:0;
    z-index:120;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:32px;
    background:
        radial-gradient(1200px 600px at 15% 20%, rgba(91,70,255,0.18), transparent 55%),
        radial-gradient(900px 500px at 85% 75%, rgba(124,58,237,0.18), transparent 55%),
        linear-gradient(180deg, var(--bg), var(--bg2) 70%);
    transition: opacity .35s ease, transform .35s ease;
    perspective: 1200px;
}
.splash.hidden{opacity:0; transform:translateY(-8px); pointer-events:none}

.splash-inner{
    width:min(880px, 100%);
    background:rgba(255,255,255,0.72);
    border:1px solid rgba(255,255,255,0.7);
    backdrop-filter: blur(10px);
    border-radius:18px;
    padding:30px 26px;
    box-shadow:0 18px 55px rgba(24,39,75,0.12);
    text-align:center;
    transform: translateZ(-80px) rotateX(10deg) rotateY(-10deg) scale(0.96);
    opacity:0;
    animation: splash-approach 1100ms cubic-bezier(.16,1,.3,1) 120ms forwards;
}

body[data-theme="dark"] .splash-inner{
    background:rgba(15,23,42,0.72);
    border:1px solid rgba(255,255,255,0.10);
}

@keyframes splash-approach{
    0%{transform: translateZ(-110px) rotateX(14deg) rotateY(-14deg) scale(0.94); opacity:0}
    60%{opacity:1}
    100%{transform: translateZ(0) rotateX(0) rotateY(0) scale(1); opacity:1}
}
.splash-badge{
    display:inline-flex;
    padding:6px 12px;
    border-radius:999px;
    font-weight:800;
    font-size:12px;
    letter-spacing:.08em;
    text-transform:uppercase;
    color:var(--primary);
    background:rgba(91,70,255,0.10);
    border:1px solid rgba(91,70,255,0.18);
}
.splash-title{margin:14px 0 8px; font-size:30px; line-height:1.15}
.splash-subtitle{margin:0 auto 16px; max-width:62ch; color:var(--muted)}
.splash-hint{margin-top:14px; color:#9aa0b4; font-size:12px}

.splash-loader{display:flex; gap:8px; justify-content:center; margin:14px 0 16px}
.splash-loader span{
    width:10px; height:10px; border-radius:999px;
    background:rgba(91,70,255,0.25);
    animation:splash-bounce 900ms ease-in-out infinite;
}
.splash-loader span:nth-child(2){animation-delay:120ms}
.splash-loader span:nth-child(3){animation-delay:240ms}
@keyframes splash-bounce{
    0%, 100%{transform:translateY(0); opacity:.55}
    50%{transform:translateY(-8px); opacity:1}
}

.splash-btn{
    width:min(420px, 100%);
    padding:12px 16px;
    border:none;
    border-radius:12px;
    font-weight:800;
    cursor:pointer;
    background:linear-gradient(90deg, var(--primary), var(--accent));
    color:white;
    box-shadow:0 12px 28px rgba(91,70,255,0.25);
}
.splash-btn:hover{filter:brightness(0.98)}

/* App reveal */
.app-hidden{opacity:0; transform:translateY(10px) scale(0.99); pointer-events:none}
.app-show{opacity:1; transform:none; pointer-events:auto}
.container{transition: opacity .35s ease, transform .35s ease}

@media (prefers-reduced-motion: reduce){
    .splash, .container, .loading-overlay, .result-card{transition:none}
    .splash-loader span{animation:none}
    .splash-inner{animation:none; transform:none; opacity:1}
}

.container{
    width:100%;
    max-width:720px;
    background:var(--card);
    border-radius:14px;
    padding:28px;
    box-shadow:0 10px 30px rgba(24,39,75,0.08);
    border:1px solid rgba(20,20,20,0.02);
}

.header h1{font-size:26px;text-align:center;margin-bottom:6px}
.subtitle{color:var(--muted);text-align:center;margin-bottom:18px}

.topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:14px}
.topbar-left{display:flex;align-items:center;gap:10px}
.top-pill{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;background:var(--panel);border:1px solid rgba(0,0,0,0.05);font-size:12px;color:var(--muted)}
body[data-theme="dark"] .top-pill{border:1px solid rgba(255,255,255,0.10)}
.top-pill .dot{width:8px;height:8px;border-radius:999px;background:rgba(91,70,255,0.65)}
.top-pill .sep{opacity:.75}

.theme-toggle{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;border:1px solid rgba(0,0,0,0.06);background:var(--panel);cursor:pointer;color:var(--text);font-weight:700;font-size:12px}
body[data-theme="dark"] .theme-toggle{border:1px solid rgba(255,255,255,0.10)}
.theme-toggle:hover{filter:brightness(0.98)}
.theme-icon{font-size:14px;line-height:1}

.input-mode{display:flex;gap:10px;justify-content:center;margin-bottom:14px}
.mode-btn{flex:1;padding:12px;border-radius:8px;border:none;background:var(--surface-2);color:var(--primary);cursor:pointer;font-weight:600}
.mode-btn.active{background:var(--primary);color:white;box-shadow:0 6px 18px rgba(91,70,255,0.18)}

.input-block{margin-bottom:12px}
.field-label{display:block;font-size:13px;color:var(--muted);margin-bottom:8px}

textarea{
    width:100%;min-height:160px;padding:14px;border-radius:10px;border:1px solid var(--border);background:var(--surface);font-size:14px;color:var(--text);
    resize:none;
}

.input-meta{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:8px}
.input-hint{font-size:12px;color:#9aa0b4}
.input-hint.error{color:var(--danger)}
.char-count{font-size:12px;color:#9aa0b4}

.file-row{display:flex;gap:12px;align-items:center}
input[type=file]{flex:0 0 auto}
.file-info{font-size:13px;color:var(--muted)}
.hint{font-size:12px;color:#9aa0b4;margin-top:6px}

.drop-zone{
    border:1px dashed rgba(91,70,255,0.35);
    background:rgba(91,70,255,0.04);
    border-radius:12px;
    padding:14px;
    outline:none;
}
.drop-zone.dragover{background:rgba(91,70,255,0.08); border-color:rgba(91,70,255,0.55)}
.drop-title{font-weight:800; color:#111; margin-bottom:4px}
.drop-title{color:var(--text)}
.drop-sub{font-size:12px; color:#9aa0b4; margin-bottom:10px}

.file-preview{
    margin-top:10px;
    background:var(--card);
    border:1px solid var(--border-2);
    border-radius:10px;
    padding:12px;
    color:var(--text);
    font-size:13px;
    white-space:pre-line;
}
.file-preview .preview-title{font-weight:800; margin-bottom:6px}
.file-preview .preview-meta{margin-top:8px; color:#9aa0b4; font-size:12px}

.primary{width:100%;margin-top:6px;padding:12px;border-radius:10px;border:none;background:var(--primary);color:white;font-weight:700;cursor:pointer}
.primary:hover{background:var(--primary-dark)}
.primary:disabled{opacity:.55; cursor:not-allowed}
.primary.ready{animation:primary-pulse 1.4s ease-in-out infinite}
@keyframes primary-pulse{0%,100%{box-shadow:0 0 0 rgba(91,70,255,0)}50%{box-shadow:0 0 0 10px rgba(91,70,255,0.10)}}
.secondary{padding:10px 14px;border-radius:8px;border:1px solid var(--border);background:var(--card);cursor:pointer;color:var(--text)}

.loading-overlay{position:fixed;left:0;top:0;right:0;bottom:0;background:rgba(10,12,20,0.34);display:flex;align-items:center;justify-content:center;z-index:60}
.loading-card{background:var(--card);padding:18px 22px;border-radius:12px;display:flex;flex-direction:column;align-items:center;gap:10px;box-shadow:0 10px 30px rgba(24,39,75,0.12)}
.spinner{width:44px;height:44px;border-radius:50%;border:5px solid rgba(0,0,0,0.06);border-top-color:var(--primary);animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

.result-card{margin-top:18px;background:var(--surface);border-radius:10px;padding:16px;border:1px solid var(--border-2)}
.result-header{display:flex;align-items:center;gap:12px}
.badge{padding:6px 12px;border-radius:999px;font-weight:700;font-size:13px}
.badge.prod{background:#dcfce7;color:var(--success)}
.badge.improd{background:#ede9fe;color:var(--accent)}
.response-text{margin-top:12px;color:var(--text);white-space:pre-line}
.result-actions{margin-top:12px;display:flex;justify-content:flex-end}
.result-actions{gap:10px}

.ghost{background:transparent;color:var(--primary);border:1px solid rgba(92,67,255,0.12);padding:10px 14px;border-radius:8px;cursor:pointer}
.ghost:hover{background:rgba(91,70,255,0.06)}

.ghost-sm{background:transparent;color:var(--primary);border:1px solid rgba(92,67,255,0.12);padding:6px 10px;border-radius:8px;cursor:pointer;font-size:12px}
.ghost-sm:hover{background:rgba(91,70,255,0.06)}

.hidden{display:none!important}

/* Used by splash after fade-out (keeps it inert even if display isn't none) */
.visually-gone{visibility:hidden}

/* Toasts */
.toasts{
    position:fixed;
    right:16px;
    bottom:16px;
    z-index:140;
    display:flex;
    flex-direction:column;
    gap:10px;
    max-width:min(380px, calc(100vw - 32px));
}
.toast{
    background:rgba(255,255,255,0.92);
    border:1px solid rgba(0,0,0,0.06);
    backdrop-filter: blur(10px);
    border-radius:12px;
    padding:12px;
    box-shadow:0 14px 35px rgba(24,39,75,0.12);
    display:flex;
    align-items:flex-start;
    gap:10px;
    transform:translateY(10px);
    opacity:0;
    animation:toast-in .22s ease forwards;
}
body[data-theme="dark"] .toast{background:rgba(15,23,42,0.92);border:1px solid rgba(255,255,255,0.10)}
.toast .t-close{color:var(--muted)}
.toast .t-dot{width:10px;height:10px;border-radius:999px;margin-top:4px;background:rgba(91,70,255,0.65)}
.toast.success .t-dot{background:rgba(22,163,74,0.7)}
.toast.error .t-dot{background:rgba(220,38,38,0.7)}
.toast .t-body{flex:1}
.toast .t-title{font-weight:800; font-size:13px; margin-bottom:2px}
.toast .t-msg{color:var(--muted); font-size:13px; line-height:1.3}
.toast .t-close{border:none;background:transparent;cursor:pointer;color:#9aa0b4;font-weight:800}
@keyframes toast-in{to{transform:none; opacity:1}}
@keyframes toast-out{to{transform:translateY(10px); opacity:0}}

/* History */
.history{margin-top:14px;background:var(--panel);border:1px solid rgba(0,0,0,0.05);border-radius:12px;padding:12px}
body[data-theme="dark"] .history{border:1px solid rgba(255,255,255,0.10)}
.history-header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}
.history-header h4{margin:0;font-size:14px}
.history-list{display:flex;flex-direction:column;gap:8px}
.history-item{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;background:var(--card);border:1px solid var(--border-2);border-radius:10px;padding:10px}
.history-left{display:flex;flex-direction:column;gap:4px}
.history-meta{font-size:12px;color:#9aa0b4}
.history-actions{display:flex;gap:8px;flex:0 0 auto}
.history-open{border:1px solid var(--border-2);background:var(--surface);border-radius:8px;padding:8px 10px;cursor:pointer;color:var(--text)}
.history-open:hover{filter:brightness(0.98)}

/* Analytics */
.analytics{margin-top:14px;background:var(--panel);border:1px solid rgba(0,0,0,0.05);border-radius:12px;padding:12px}
body[data-theme="dark"] .analytics{border:1px solid rgba(255,255,255,0.10)}
.analytics-header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}
.analytics-header h4{margin:0;font-size:14px}
.analytics-grid{display:grid;grid-template-columns:repeat(4, minmax(0,1fr));gap:10px}
.a-card{background:var(--card);border:1px solid var(--border-2);border-radius:10px;padding:10px}
.a-label{font-size:12px;color:var(--muted)}
.a-value{font-size:20px;font-weight:900;color:var(--text);margin-top:4px}
.analytics-meta{margin-top:10px;font-size:12px;color:var(--muted)}

/* Fade helpers */
.loading-overlay, .result-card{
    opacity:0;
    transform:translateY(6px);
    transition:opacity .28s ease, transform .28s ease;
}
.loading-overlay.show, .result-card.show{
    opacity:1;
    transform:none;
}

@media(max-width:760px){
    body{padding:22px}
    .container{max-width:680px}
}

@media(max-width:520px){
    body{padding:14px; align-items:flex-start}
    .container{padding:16px; border-radius:14px; margin-top:10px}

    .header h1{font-size:22px}
    .subtitle{font-size:13px; margin-bottom:14px}

    .input-mode{flex-direction:column}
    .mode-btn{padding:11px}

    textarea{min-height:180px}

    .file-row{flex-direction:column; align-items:stretch}
    input[type=file]{width:100%}
    .file-info{padding-top:6px}

    .result-header{flex-direction:column; align-items:flex-start}
    .result-actions{flex-direction:column; align-items:stretch; justify-content:stretch}
    .secondary,.ghost{width:100%}

    .toasts{right:12px;left:12px;bottom:12px;max-width:none}
    .history-actions{flex-direction:column}

    .topbar{flex-direction:column; align-items:stretch}
    .topbar-right{width:100%}
    .theme-toggle{width:100%; justify-content:center}
    .top-pill{width:100%; justify-content:center}

    .analytics-grid{grid-template-columns:repeat(2, minmax(0,1fr))}

    .splash{padding:18px}
    .splash-inner{padding:22px 18px; border-radius:16px}
    .splash-title{font-size:24px}
    .splash-subtitle{font-size:13px}
}

@media(max-width:360px){
    .splash-title{font-size:22px}
    .header h1{font-size:20px}
}
